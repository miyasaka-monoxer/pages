<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
    <meta http-equiv="Content-Type" content="text/html" charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>年賀問題「あるスタートアップのリファラル事情」解説編 - 最も良い現在</title>
    <meta name="description" content="令和7年の年賀問題だった「あるスタートアップのリファラル事情」の解説です。会社の人物相関図が何通り想像できるかという問題について、正解とその導き方を説明します。">

    <meta property="og:title" content="年賀問題「あるスタートアップのリファラル事情」解説編 - 最も良い現在">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://miyasaka-monoxer.github.io/pages/R071205">
    <meta property="og:image" content="https://miyasaka-monoxer.github.io/pages/images/1764943328325-ogp.jpg">
    <meta property="og:description" content="令和7年の年賀問題だった「あるスタートアップのリファラル事情」の解説です。会社の人物相関図が何通り想像できるかという問題について、正解とその導き方を説明します。">
    <meta property="og:locale" content="ja_JP">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="">

    <link rel="icon" type="image/vnd.microsoft.icon" href="favicon.ico">
    <link rel="stylesheet" type="text/css" href="css/style.css" media="screen,print">
    <link rel="stylesheet" type="text/css" href="css/mobile.css" media="handheld">
    <link rel="stylesheet" type="text/css" href="css/special.css" media="screen,print">
</head>
<body>
<div class="all">
<header>
    <nav>
        <a href="./">最も良い現在</a> › 雑記 › <a href="./R071205">年賀問題「あるスタートアップのリファラル事情」解説編</a>
    </nav>
    <hr>
    <h1>年賀問題「あるスタートアップのリファラル事情」<br />解説編</h1>
    <hr>

    <address>宮坂　聡</address>
</header>
<div class="main">
    <div class="banner monoxer-link">
        <p>これは <a href="https://qiita.com/advent-calendar/2025/monoxer">モノグサ Advent Calendar 2025</a>
            の 5 日目の記事です。</p>
    </div>
    <p>筆者の勤務先である<a href="https://careers.monoxer.com/" target="_blank">モノグサ社</a>では、「未体験への挑戦」という行動指針を掲げています。</p>
    <p>そして、「未体験への挑戦」は、今年のアドベントカレンダーの執筆テーマでもあります。</p>
    <p>さて、<a type="application/atom+xml" href="./feed.atom">Atom フィード</a>をフォローしてくれている方はご存知だと思いますが、今年の 1 月に当ブログでは「<a href="./R070101">あるスタートアップのリファラル事情</a>」という記事を掲載しました。年始に帰省した主人公が、幼馴染に呼び出されてファミレスでリファラルを受ける話です。</p>
    <p>このスタートアップというのは、モノグサ社のことではなく、物語の中に登場する架空の会社なのですが、しかしモノグサ社ともいくつかの共通点があるようです。</p>
    <p>一つはスタートアップであること。会社の規模としては、物語の中の会社では社員が 8 人しかいないのに対して、モノグサ社では 200 人近いので、ずいぶん違いがありますが、いずれもスタートアップであることは変わりません。</p>
    <p>もう一つは、リファラル採用に力を入れていること。つまり、採用のルートとして求人サイトなどよりも、既存社員の紹介による人材募集を重視するということです。もっとも、物語の中の会社のように「リファラルのみ」というのは極端ですし（しかし、その人数の会社では割とあることだとも思います）、モノグサ社では私も含めて求人サイトから来た人も多いですが、それでもリファラルは主要なルートの一つです。</p>
    <p>そしてもう一つは、挑戦を支援する姿勢。主人公の友人は、自分だけでなく他人や会社の成長のために、自分からアクションを取っている行動力のある人物として描かれています。それは、モノグサ社でも推奨されていることです。</p>
    <p>ただ、問題を掲載しておきながら、解説編を掲載していなかったので、ここで記しておくことにしましょう。</p>
    <h2>物語のあらすじ</h2>
    <p>元記事はちょっとした物語形式になっていて長いので、問題の部分だけを再掲しておきます。主人公が、スタートアップのリファラルに関心を示したところからです。</p>
    <blockquote>
        <p>（<a href="./R070101">あるスタートアップのリファラル事情</a>）</p>
        <p>友人が紹介した求人について、その熱量に押されたあなたは、「ちょっと興味はある」と答えました。</p>
        <p>すると、友人は嬉しそうに一枚のメモを広げます。</p>
        <p>「ありがとう。その場合はね、開発部長からメッセージを預かってるんだ」</p>
        <blockquote class="message">
            <p>当社開発職へのエントリーありがとうございます。</p>
            <p>当社には、営業職 3 名と開発職 5 名のあわせて 8 名の社員がいます。このうち、営業職である創業者 1 名を除き、他の 7 名は、それぞれ当時の既存社員 1 名を推薦人として、推薦人からの推薦によって採用されました。</p>
            <p>その際、当社では、推薦人について、入社者と異なる職種（営業職→開発職、開発職→営業職）でなければならないという条件を課しています。また、創業以来、退職した者はいません。</p>
            <p>これらの情報にもとづいて、当社の人物相関図を想像するとき、あり得る人物相関図は何通りあるでしょうか？</p>
            <p class="img right"><img src="images/R070101-image2.jpg" alt="人物相関図"></p>
            <p>ただし、人物相関図とは、紙面上に社員の顔写真を配置し、「推薦した→推薦された」という関係を表すために、推薦した社員を起点、推薦された社員を終点とする矢印を描き込んだ図のことをいいます。また、人物相関図を数える際には、写真の配置や矢印の描き方が異なっても、全く同じ「推薦した→推薦された」関係を表している人物相関図は、まとめて 1 通りとして数えます。</p>
            <hr class="break" />
        </blockquote>
        <p>読み終わると、友人はメッセージの紙をテーブルに置いて、あなたが読みやすい向きに直しました。</p>
        <p>余白がずいぶん大きいのは、計算用紙ということなのでしょう。</p>
        <p>「飲み物取ってくるね。何がいい？」</p>
        <p>あなたは「アイスコーヒー」と告げて、ドリンクバーに向かう友人を見送ると、バッグからボールペンを取り出し、考察を始めることにしました。</p>
        <hr class="break" />
    </blockquote>
    <p>アイスコーヒーは、ドリンクバーの中では時間がかかりそうな飲み物です。もし混雑していれば、3 分くらいは時間が稼げるかもしれません。主人公は、とっさに機転を利かせることができる人物なのですね。</p>
    <p>それでは、その 3 分間で、主人公はどんなことを考えるのでしょうか。</p>
    <p>なお、問題文がやや不明瞭ですが、設定として「誰が創業者であるかは知っているが、他の社員の入社順は知らない」という前提で考えるものと補足させてください。</p>
    
    <h2>数学の言葉に置き換える</h2>
    <p>本問は、「何通りありますか」という問題です。このようなものは、数え上げの問題とよばれていますね。とくに本問では、問題文で示された「人物相関図」というものが何通りあり得るかを考えています。</p>
    <p>数え上げの問題なので、順列や組合せなどといった、数学の手法を使って考えていくのがよさそうです。そのためには、日常の日本語で書かれた文章題のままではなく、数学の用語を使った形に読み替えることが第一歩です。</p>
    <p>問題文に書かれていることを、一つ一つ、数学の言葉に置き換えていきましょう。</p>
    
    <h3>「人物相関図」</h3>
    <p>まず、本問の関心の対象である「人物相関図」を数学的な対象としてとらえなければなりません。離散グラフを知っている人なら、このようなものは直ちに、離散グラフを使って表現したくなるでしょう。</p>
    <p>問題文によると、写真の配置や矢印の描き方は考慮せず、「どれとどれがつながっているか」だけを考慮するといいます。これは、まさに離散グラフの特徴に他ならないからです。</p>
    <p>具体的には、「社員の顔写真」をグラフの頂点とし、それを結ぶ「矢印」をグラフの辺とすればよさそうです。</p>
    <p class="img"><img alt="図　人物相関図とグラフ"></p>

    <h3>有向グラフと無向グラフ</h3>
    <p>ところで、一つ気になることがあります。</p>
    <p>離散グラフには「有向グラフ」と「無向グラフ」がありますね。いずれも、頂点（ノード）を辺（エッジ）でつないだものであることは同じですが、有向グラフでは辺の始点と終点を区別するのに対し、無向グラフでは始点と終点を区別しないという違いがあります。</p>
    <p class="img"><img alt="図　有向グラフと無向グラフ"></p>
    <p>本問では、どちらを使うのが良いでしょうか？</p>
    <p>おそらく、問題文を素直に読めば、「有向グラフを使う」という発想になりそうです。実際、問題文には「推薦した社員を起点、推薦された社員を終点とする矢印を描き込んだ図」とあるので、これをグラフで表現するなら、有向グラフとするのが自然でしょう。</p>
    <p>しかし、実は始点と終点の違いを無視して、無向グラフとして表すのがうまいのです。このことについては、あとで説明しましょう。</p>

    <h3>頂点がもつ情報</h3>
    <p>他にも条件がありますね。問題文では、社員について「営業職」と「開発職」という区分があり、その区分によって、矢印で結んでよいかどうかが制限を受けています。</p>
    <p>このような区分は、グラフの言葉でいえば、頂点に「色」があるということです。そして、矢印で結んでよいかどうかの制限は、グラフでは「辺の両端が同じ色であってはならない」という条件で表すことができます。</p>
    <p class="img"><img alt="図　人物相関図"></p>
    <p>また、これらの頂点が「人」（あるいは、その写真）を表していることにも留意をしなければなりません。数え上げの問題では、慣習として、「玉」や「カード」などの物品は互いに区別をしないのに対し、「人」は一つ一つ区別をするというのが暗黙の了解です。</p>
    <p>このことは、グラフの言葉でいえば、頂点に「番号」あるいは「名前」がついているということができます。</p>
    <p>問題文によれば、「営業職」の社員が 3 人と、「開発職」の社員が 5 人いるということですね。</p>
    <p>これをグラフの言葉で表すと、たとえば以下のようになるでしょう。</p>
    <ul>
        <li>3 つの白い頂点があり，名前は A<sub>1</sub>, A<sub>2</sub>, A<sub>3</sub></li>
        <li>5 つの黒い頂点があり，名前は B<sub>1</sub>, B<sub>2</sub>, B<sub>3</sub>, B<sub>4</sub>, B<sub>5</sub></li>
        <li>辺の両端が同じ色であってはならない
    </ul>
    <p>なお、この 3 つめの条件には、典型的な読み替えがあるのですが、それは後で説明します。</p>

    <h2>条件をもれなく読み替える</h2>
    <p>問題文で、まだ数学の言葉に読み替えていない条件はどこでしょうか？</p>

    <h3>すべての社員がつながる</h3>
    <p>まだ読み替えていないのは、「営業職である創業者 1 名を除き、他の 7 名は、それぞれ当時の既存社員 1 名を推薦人として、推薦人からの推薦によって採用されました。」という部分です。</p>
    <p>有向グラフでいえば、下の図のように、特定の白い頂点 A<sub>1</sub> を根とした根付き木であるということを意味しています。（ループや合流、逆流、離れた部分がないということです。）</p>
    <p class="img"><img alt="図　根付き木と、良くない例"></p>
    <p>では、無向グラフでいえばどうでしょうか？</p>
    <p>このときは、合流とか逆流といった概念はないので、単に「木である」という一言で表すことができます。</p>
    <p class="img"><img alt="図　木"></p>
    <p>そして、ここで「無向グラフで考えてよいのか」という話に戻りましょう。</p>
    <p>本問は、有向グラフで考えれば、「A<sub>1</sub> を根とする根付き木」が何通りあるかを数える問題です。これを、無向グラフで考えて、単に「木」が何通りあるかを数えることにしてしまおうというのですね。</p>
    <p>それを大丈夫と言うためには、有向グラフの「A<sub>1</sub> を根とする根付き木」と、無向グラフの「木」が 1 対 1 に対応づけられることを示す必要があります。</p>
    <p class="img"><img alt="図　根付き木と、良くない例"></p>
    <p>まず、有向グラフの根付き木を、無向グラフの木に対応させることは、自明に可能です。辺の始点と終点を忘れてしまえばよいですね。</p>
    <p>逆に、無向グラフの木から、有向グラフの根付き木を得ることもできます。各辺について、両端のうち A<sub>1</sub> に近いほうを始点とし、A<sub>1</sub> から遠いほうを終点とすればよいだけです。</p>
    <p>こういうわけで、本問は有向グラフではなく、無向グラフで考えることができます。これにより、合流や逆流といった面倒なことを考えなくてすむようになるわけです。</p>

    <h3>辺の両端の色が異なる</h3>
    <p>先ほど後回しにした、「辺の両端が同じ色であってはならない」という条件の扱い方を説明しましょう。</p>
    <p>端的に言うと、これは「二部グラフである」という一言でまとめるのが定石です。</p>
    <p>二部グラフというと、下の図のように「頂点が 2 つの集合に分かれていて、それらの間に辺が張られている」というイメージをもつことが多いかもしれません。</p>
    <p>しかし、2 つの集合を「色」とよぶことにすれば、これは「頂点が 2 色に塗り分けてありって、異なる色の頂点を結ぶ辺が張られている」という状況を言い換えたにすぎないわけです。</p>
    <p class="img"><img alt="図　二部グラフと、辺の両端が異なる色"></p>
    <p>さあ、結論にせまってきました。ここまでをまとめると、問題はこのようになります。</p>
    <blockquote>
        <p>1 つの頂点集合が { A<sub>1</sub>, A<sub>2</sub>, A<sub>3</sub> } であり、もう 1 つの頂点集合が { B<sub>1</sub>, B<sub>2</sub>, B<sub>3</sub>, B<sub>4</sub>, B<sub>5</sub> } である二部グラフを考えるとき、木であるものは何通りありますか？</p>
    </blockquote>
    <p>ここで、ややあいまいな言い方をしていますが、木に含まれていない頂点が残っているものは不可というのが、上の問題文の意図です。</p>
    <h3>すべての頂点を通る木</h3>
    <p>ここまでは、まず頂点の集合を考えて、初めは辺がない状態から、辺を増やすことで木をつくるというイメージを描いてきました。</p>
    <p>しかし、このような場面では、逆転の発想で、「初めに、あり得るすべての辺を描いておき、不要な辺を消して木にする」という表現の仕方をするのが定石です。</p>
    <p class="img"><img alt="図　辺を生やして木にする vs 辺を消して木にする"></p>
    <p>この見方をすれば、問題は「完全二部グラフの全域部分木」というテーマだったことが分かります。問題文は以下のようになります。</p>
    <blockquote>
        <p>完全二部グラフ <i>K</i><sub>3,5</sub> の全域部分木はいくつあるか。</p>
    </blockquote>
    <p>なお、<i>K</i><sub>3,5</sub> とは、2 つの集合に分けた頂点の個数が 3 個と 5 個である完全二部グラフのことです。</p>

    <h2>公式にあてはめて計算する</h2>
    <p>ここまで簡略化されれば、あとはどうにかなるでしょう。</p>
    <p>以下の公式が知られています。</p>
    <blockquote>
        <p>完全二部グラフ <i>K</i><sub><var>a</var>,<var>b</var></sub> がもつ全域部分木は <var>a</var><sup><var>b</var>−1</sup>⋅<var>b</var><sup><var>a</var>−1</sup> 通りである。</p>
    </blockquote>
    <p>3<sup>5−1</sup>⋅5<sup>3−1</sup> を計算して、答えは 2025 となります。</p>

    <h3>物語の結末</h3>
    <p>さて、主人公は、アイスコーヒーが出来上がるまでの 3 分間でここまでの考察ができたのでしょうか。</p>
    <p>問題を読み替えて簡略化することができたとしても、公式を知らなければ、3 分で答えを出すのは厳しいかもしれません。（この公式の導出は、かなり込み入った考察が必要であり難しいです。）</p>
    <p>しかし、パソコンを使ってよければ、ネット検索ですぐにこの式を見つけることはできるでしょう。筆者も、今まで知らなかったのですが、この記事の執筆に際して <a target="blank" href="https://oeis.org/A072590">OEIS</a> や <a target="blank" href="https://ja.wikipedia.org/wiki/%E5%AE%8C%E5%85%A82%E9%83%A8%E3%82%B0%E3%83%A9%E3%83%95#%E7%89%B9%E6%80%A7">Wikipedia</a> を見たことなどによって最近知りました。</p>
    <p>もっとも…。</p>
    <p>手早く答えを出してしまうことが、本当に最適であるかどうかは、筆者にはわかりません。</p>
    <p>久しぶりに幼馴染と会ったのですから、積もる話もあるでしょう。パソコンを使って、処理に 1 時間くらいかかる全探索のプログラムを書き、答えが出るのを待ちながら、ドリンクバーのコーヒーで時間をつぶすのが最適という可能性もありそうです。</p>
    <p class="space-image"><img src="./images/1764943328325-ogp.jpg"></p>
    <div class="banner monoxer-link">
        <p>これは <a href="https://qiita.com/advent-calendar/2025/monoxer">モノグサ Advent Calendar 2025</a> の 5 日目の記事です。</p>
    </div>
    <div class="banner monoxer-link">
        <div>
        <p>モノグサ株式会社では一緒に働く仲間を募集しています！</p>
        <p class="banner-main"><a href="https://careers.monoxer.com/">モノグサ株式会社 採用サイト</a></p>
        <p>私のように他職種から転職したエンジニアも複数名います。興味を持ってくださった方、ぜひお話しましょう。上のリンク先から「カジュアル面談」のお申し込みをお待ちしています。</p>
        </div>
    </div>



</div>

<footer>
    <nav>
        <a href="./">最も良い現在</a> › 雑記 › <a href="./R071205">年賀問題「あるスタートアップのリファラル事情」解説編</a>
    </nav>
</footer>

</div>
</body>
</html>
